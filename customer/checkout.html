<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Thanh toán</title>
  <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
<h2>Thông tin đặt hàng</h2>
<form id="f">
  <input name="name" placeholder="Họ tên" required>
  <input name="address" placeholder="Địa chỉ" required>
  <input name="phone" placeholder="Điện thoại" required>
  <button>Đặt hàng</button>
</form>
<div id="msg"></div>
<script>
f.onsubmit=e=>{
  e.preventDefault()
  let cart=JSON.parse(localStorage.getItem('cart')||'[]')
  if(!cart.length)return msg.textContent='Giỏ hàng trống'
  fetch('http://localhost:3000/api/orders',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      orderDate:new Date(),
      requiredDate:new Date(),
      status:'In Process',
      customerNumber:103,
      items:cart.map((i,n)=>({productCode:i.code,quantity:i.qty,price:i.price}))
    })
  }).then(r=>r.json()).then(x=>{
    localStorage.removeItem('cart')
    msg.textContent='Đặt hàng thành công #'+x.orderNumber
  })
}
</script>
</body>
</html>
