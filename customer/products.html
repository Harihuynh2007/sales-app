<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Sản phẩm</title>
  <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
<header><nav>
  <a href="index.html">Trang chủ</a>
  <a href="products.html">Sản phẩm</a>
  <a href="cart.html">Giỏ hàng</a>
</nav></header>
<main>
  <input id="kw" placeholder="Tìm kiếm">
  <button onclick="load()">Lọc</button>
  <div id="list" class="grid"></div>
</main>
<script>
function load(){
  const k=document.getElementById('kw').value
  fetch('http://localhost:3000/api/products?search='+k)
  .then(r=>r.json()).then(d=>{
    list.innerHTML=d.map(p=>`
    <div class="card">
      <h4>${p.productName}</h4>
      <p>${p.MSRP}₫</p>
      <button onclick="add('${p.productCode}','${p.productName}',${p.MSRP})">Thêm</button>
    </div>`).join('')
  })
}
function add(code,name,price){
  let c=JSON.parse(localStorage.getItem('cart')||'[]')
  const f=c.find(i=>i.code==code)
  f?f.qty++:c.push({code,name,price,qty:1})
  localStorage.setItem('cart',JSON.stringify(c))
}
load()
</script>
</body>
</html>
